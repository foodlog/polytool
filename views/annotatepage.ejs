<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>

    <meta charset="utf-8">
    <title>Annotation Tool</title>
    <link rel="stylesheet" type="text/css" href="/stylesheets/master.css">

    <!-- Bootstrap CDN -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <!-- AJAX for JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <script>
        var input = <%- JSON.stringify(input) %>
    </script>
    <!-- Our JS Code-->
    <script src="/javascripts/annotatefunc.js"></script>
</head>

<body>

    <div class="card" id="top-card">
        <div class="card-body">
            <center>
                <h1>Image Annotation Tool</h1>
                <p id="credits"><i>Cardiff University School of Computer Science & Informatics</i></p>
            </center>
            <p>This tool was developed to build a dataset of annotated images - which will eventually be used to contribute to our machine learning model.
                <br> We'd appreciate it if you were to contribute to our dataset. Here's some more information about the task:</p>
            <ul>
                <li>First, you'll be presented with some trial tasks, where <b>the parameters of the correct annotations have already been submitted</b>:
                    <br> this is to ensure that the annotations we contribute to our dataset are accurate enough.
                </li>
                <li>Draw a contour using the <b>mouse left button</b> to click and connect points.</li>
                <li>To finish the contour polygon use the <b>mouse right button</b>. This will connect the first to the last point.</li>
                <li>Remove the last point by clicking <b>Ctrl + mouse click</b> or click on the <b>Undo button</b>.</li>
                <li>Clear all points by clicking on the <b>Reset button</b>.</li>
                <li>To go into <b>Delete Mode</b>, click the <b>Delete button</b>. This will allow you to remove multiple polygons at once.</li>
                <li>Once you have completed all annotations, press <b>Submit</b>.</li>
            </ul>

            <ul>
                <li>A good contour must be drawn close to the object's boundaries.
                    <br /> Please take a look at the example figures...</li>
                 <%if (input.possibleAnnotations != undefined && input.possibleAnnotations.length > 0 ) { %>
                <li> The possible annotations for this dataset are 
                        <ul>
                            <% input.possibleAnnotations.forEach(function(anno){ %>
                            <li> <%= anno %> </li>
                            <% })%>
                        </ul>
                    </li>
                <% } %>
            </ul>
            <a type="link" class="btn btn-link btn-sm" href="/images/examples/example1.html" target="_blank">Example 1</a>
            <a type="link" class="btn btn-link btn-sm" href="/images/examples/example2.html" target="_blank">Example 2</a>
            <a type="link" class="btn btn-link btn-sm" href="/images/examples/example3.html" target="_blank">Example 3</a>
            <a type="link" class="btn btn-link btn-sm" href="/images/examples/example4.html" target="_blank">Example 4</a>
        </div>
    </div>
    <!-- Coordinates input from user -->
    <!-- <strong>Coordinates:</strong> <textarea disabled="disabled" id="coordinates" name="coordinates" style="width:300px; height:200px;"></textarea> -->
    <input id="coordinates" name="coordinates" type="hidden" />
    <div id="imgcard" class="card" align="middle">
        <div id="imgframe" class="card-img-top">
            <!--change the data-imgsrc="${img_url}" - Currently got a hardcoded image for an example. -->
            <p id="imgcanvas">
                <canvas data-imgsrc="<%=input.images[0].imageUrl%>" id="jPolygon" oncontextmenu="return false;" onmousedown="point_it(event)" style="cursor:crosshair"> Your browser does not support the HTML5 canvas tag. </canvas>

                <div class="card-body">
                    <p class="card-text">Press <b>Left Click</b> to draw a point, <strong>CTRL+Click</strong> to undo or <strong>Right Click</strong> to close the polygon.</p>
                    <p id="buttons">
                        <input onclick="deleteFunc()" id="delete_button" type="button" value="Delete" class="btn btn-primary" />
                        <input id="undo_button" onclick="undoButton()" type="button" value="Undo" class="btn btn-outline-primary" />
                        <input id="reset_button" type="Reset" value="Reset" class="btn btn-outline-primary" />
                        <input id="submit_button" type="button" onclick="submitButton()" value="Submit" class="btn btn-primary" />
                    </p>
                </div>
        </div>
    </div>

    <div style="display:block; vertical-align:top; float:left; margin-left:20px;">
        <!--<p><label for="comment"><em>Comment:</em></label><textarea id="comment_area" name="comment"></textarea></p>-->
    </div>

</body>

</html>